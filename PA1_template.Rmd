---
title: "Activity Monitoring Data Analysis"
date: "`r Sys.Date()`"
output: html_document
---

## **Loading and Preprocessing the Data**

```{r load_data, echo=TRUE}
library(dplyr)
library(ggplot2)

zip_file <- "repdata_data_activity.zip"
csv_file <- "activity.csv"
if (!file.exists(csv_file)) {
  unzip(zip_file)
}

activity_data <- read.csv(csv_file, stringsAsFactors = FALSE)

activity_data$date <- as.Date(activity_data$date, format="%Y-%m-%d")

head(activity_data)
```

## **Total Number of Steps Taken Per Day**

```{r total_steps_per_day, echo=TRUE}

daily_steps <- activity_data %>%
  group_by(date) %>%
  summarise(total_steps = sum(steps, na.rm = TRUE))

ggplot(daily_steps, aes(x = total_steps)) +
  geom_histogram(binwidth = 1000, fill="blue", color="black", alpha=0.7) +
  labs(title = "Histogram of Total Steps Per Day", x = "Total Steps", y = "Frequency") +
  theme_minimal()
```

```{r mean_median_steps, echo=TRUE}
# Compute mean and median
mean_steps <- mean(daily_steps$total_steps, na.rm = TRUE)
median_steps <- median(daily_steps$total_steps, na.rm = TRUE)

# Print results
mean_steps
median_steps
```

## **Average Daily Activity Pattern**

```{r time_series_plot, echo=TRUE}

interval_avg <- activity_data %>%
  group_by(interval) %>%
  summarise(avg_steps = mean(steps, na.rm = TRUE))

ggplot(interval_avg, aes(x = interval, y = avg_steps)) +
  geom_line(color="red") +
  labs(title = "Average Daily Activity Pattern", x = "5-Minute Interval", y = "Average Steps") +
  theme_minimal()
```

```{r max_interval, echo=TRUE}

max_interval <- interval_avg %>%
  filter(avg_steps == max(avg_steps))

max_interval
```

## **Imputing Missing Values**

```{r missing_values, echo=TRUE}

total_missing <- sum(is.na(activity_data$steps))
total_missing
```

```{r impute_missing_values, echo=TRUE}
interval_means <- activity_data %>%
  group_by(interval) %>%
  summarise(mean_steps = mean(steps, na.rm = TRUE))

activity_imputed <- activity_data %>%
  left_join(interval_means, by="interval") %>%
  mutate(steps = ifelse(is.na(steps), mean_steps, steps)) %>%
  select(-mean_steps)
```

```{r histogram_imputed, echo=TRUE}
daily_steps_imputed <- activity_imputed %>%
  group_by(date) %>%
  summarise(total_steps = sum(steps))

ggplot(daily_steps_imputed, aes(x = total_steps)) +
  geom_histogram(binwidth = 1000, fill="green", color="black", alpha=0.7) +
  labs(title = "Histogram of Total Steps Per Day (Imputed Data)", x = "Total Steps", y = "Frequency") +
  theme_minimal()
```

## **Weekday vs. Weekend Activity**

```{r classify_weekdays, echo=TRUE}
activity_imputed <- activity_imputed %>%
  mutate(day_type = ifelse(weekdays(date) %in% c("Saturday", "Sunday"), "Weekend", "Weekday"))
activity_imputed$day_type <- factor(activity_imputed$day_type, levels = c("Weekday", "Weekend"))
```

```{r weekday_vs_weekend_plot, echo=TRUE}

interval_avg_daytype <- activity_imputed %>%
  group_by(interval, day_type) %>%
  summarise(avg_steps = mean(steps))

ggplot(interval_avg_daytype, aes(x = interval, y = avg_steps, color=day_type)) +
  geom_line() +
  facet_wrap(~day_type, ncol=1) +
  labs(title = "Activity Pattern (Weekday vs. Weekend)", x = "5-Minute Interval", y = "Average Steps") +
  theme_minimal()
```


